<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <button onclick="changeText()">Start</button>
    <button
      onclick="
      displayMessage();
    "
    >
      Add to Cart
    </button>
    <p class="display-added"></p>

    <button
      onclick="
    
    
    message++;
    displayNotification()"
    >
      add
    </button>
    <button
      onclick="

      if(message>0){
        message--

      // if there are no new messages stop displaying the notification in the tab

        if(message===0){
          stopNotification();
        }
      }

    
    
    "
    >
      remove
    </button>
    <script>
      let add = function () {
        console.log(2 + 3);
      };

      function runTwice(fun) {
        fun();
        fun();
      }
      runTwice(add);

      function changeText() {
        const ourButton = document.querySelector("button");
        ourButton.innerHTML = "Loading...";
        setTimeout(function () {
          document.querySelector("button").innerHTML = "Finished!";
        }, 1000);
      }

      let timeoutId;

      function displayMessage() {
        document.querySelector(".display-added").innerHTML = "Added";
        console.log(timeoutId);
        clearTimeout(timeoutId);
        timeoutId = setTimeout(function () {
          document.querySelector(".display-added").innerHTML = "";
        }, 2000);
      }

      let message = 2;

      let intervalId;

      let isDisplayingNotification;

      displayNotification();

      function displayNotification() {
        if (isDisplayingNotification) {
          return;
        }

        isDisplayingNotification = true;
        intervalId = setInterval(function () {
          if (document.title === "App") {
            document.title = `(${message}) New messages`;
          } else {
            document.title = "App";
          }
        }, 1000);
      }

      function stopNotification() {
        isDisplayingNotification = false;
        clearInterval(intervalId);
        document.title = "App";
      }
    </script>
  </body>
</html>
